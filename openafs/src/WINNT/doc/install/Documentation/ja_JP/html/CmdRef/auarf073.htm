<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理解説書</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- C:\IDWB\TEMP\idwt1068\AUARF000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 21:46:04            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 21:46:02">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 21:46:02">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 21:46:02">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    -->
<BODY bgcolor="ffffff">
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理解説書</H1>
<P>
<H2><A NAME="HDRBK_DUMP" HREF="auarf002.htm#ToC_87">backup dump</A></H2>
<A NAME="IDX4302"></A>
<A NAME="IDX4303"></A>
<A NAME="IDX4304"></A>
<A NAME="IDX4305"></A>
<A NAME="IDX4306"></A>
<A NAME="IDX4307"></A>
<A NAME="IDX4308"></A>
<A NAME="IDX4309"></A>
<A NAME="IDX4310"></A>
<A NAME="IDX4311"></A>
<A NAME="IDX4312"></A>
<A NAME="IDX4313"></A>
<A NAME="IDX4314"></A>
<A NAME="IDX4315"></A>
<P><STRONG>目的</STRONG>
<P>ダンプを作成します (特定のダンプ・レベルのボリューム・セットのダンプを作成します)。
<P><STRONG>構文</STRONG>
<PRE><B>backup dump</B> [<B>-volumeset</B> &lt;<VAR>volume set name</VAR>>]  [<B>-dump</B> &lt;<VAR>dump level name</VAR>>]
            [<B>-portoffset</B> &lt;<VAR>TC port offset</VAR>>]  [<B>-at</B> &lt;<VAR>Date/time to start dump</VAR>><SUP>+</SUP>]
            [<B>-append</B>]  [<B>-n</B>]  [<B>-file</B> &lt;<VAR>load file</VAR>>]
            [<B>-localauth</B>]  [-<B>cell</B> &lt;<VAR>cell name</VAR>>]  [<B>-help</B>]

<B>backup dump</B> [<B>-v</B> &lt;<VAR>volume set name</VAR>>]  [<B>-d</B> &lt;<VAR>dump level name</VAR>>]
            [<B>-p</B> &lt;<VAR>TC port offset</VAR>>]  [<B>-at</B> &lt;<VAR>Date/time to start dump</VAR>><SUP>+</SUP>]
            [<B>-ap</B>]  [<B>-n</B>]  [<B>-f</B> &lt;<VAR>load file</VAR>>]  [<B>-l</B>]  [<B>-c</B> &lt;<VAR>cell name</VAR>>]  [<B>-h</B>]
</PRE>
<P><STRONG>構文</STRONG>
<P><B>backup dump</B> コマンドは、
<B>-volumeset</B> 引き数で指定されたボリューム・セットのダンプを <B>-dump</B> 引き数で指定されたダンプ・レベルで作成し、ダンプに関するダンプ・レコードをバックアップ・データベースに作成します。または、<B>-file</B> 引き数で指定されたファイルのダンプ命令を実行します。
<B>-portoffset</B> 引き数 (またはファイルの各コマンドで) 指定されたテープ・コーディネーターが操作を実行します。
<P>(指定されたポート・オフセットに関連付けられたテープ・コーディネーター・マシン上の <B>/usr/afs/backup/CFG_</B><VAR>device_name</VAR> ファイルに <B>FILE YES</B> がある場合、バックアップ・システムは、磁気テープではなく、テープ・コーディネーターの <B>/usr/afs/backup/tapeconfig</B> ファイルのポート・オフセットにリストされているバックアップ・データ・ファイルにデータのダンプを作成します。説明を分かりやすくするために、以下では磁気テープ装置の場合について説明しますが、バックアップ・データ・ファイルの取り扱いは磁気テープ装置の場合とほとんど同じです。)
<P><I>ダンプの作成</I> という用語は、データのコレクションを磁気テープまたはバックアップ・データ・ファイルにコピーすることを意味します。また、結果的に作成されたコレクションのことを<I>ダンプ</I> といいます。複数のダンプを含む磁気テープのセットを<I>ダンプ・セット</I> といいます。ダンプ・セットの最初のダンプを<I>初期ダンプ</I> といい、ダンプ・セットに追加された後続のダンプ (<B>-append</B> 引き数を使用します) を<I>追加ダンプ</I> といいます。付加ダンプの作成はオプションです。付加ダンプは、初期ダンプと異なるボリューム・セットに作成することも、異なるダンプ・レベルに作成することもできます。
<P><I>フル・ダンプ</I> は、ダンプ階層のフル・ダンプ・レベルで作成されます。このダンプには、ダンプ作成時にボリューム・セットのボリュームに存在するすべてのデータが入ります。
<I>インクリメンタル・ダンプ</I> は、インクリメンタル・ダンプ・レベルで作成されます。このダンプには、インクリメンタル・ダンプの<I>親ダンプ・レベル</I> (階層内でインクリメンタル・ダンプのすぐ上のダンプ・レベル) でボリューム・セットのダンプが作成されてから変更されたデータだけが入ります。このダンプは、フル・ダンプ・レベルの場合も、インクリメンタル・ダンプ・レベルの場合もあります。さらに具体的にいえば、インクリメンタル・ダンプには、親ダンプ・レベルに含まれるボリュームの<I>複製日</I>よりも新しい修正タイム・スタンプを持つファイルとディレクトリーが含まれます。バックアップおよび読み取り専用ボリュームの場合、複製日は、ボリュームをダンプに組み込む前に、読み取り / 書き込みの送信元から複製した時刻です。読み取り / 書き込みボリュームの場合は、親ダンプに組み込むためにボリュームをロックした時刻を表します。複製日は、<B>backup volinfo</B> コマンドの出力の <VAR>clone date</VAR> フィールドに表示されます。たとえば、<B>/full/week1/thursday</B> レベルのインクリメンタル・ダンプには、
<B> /full/week1</B> レベルでボリューム・セットのダンプが作成されてから変更されたファイルおよびディレクトリーだけが入ります。
<P><B>異なるタイプのダンプ操作を開始する場合</B>
<P>関連するテープ・コーディネーターが使用可能になってすぐにダンプ操作を開始する場合には、
<B>-volumeset</B>、
<B>-dump</B>、<B>-portoffset</B> オプションをだけを指定します。必要であれば、<B>-append</B> オプションを指定することもできます。単一の <B> backup dump</B> コマンドを後で実行するようにスケジュールする場合には、
<B> -at</B> 引き数に開始時刻を指定することができます。
<P>既存のダンプ・セットにダンプを付加する場合には、
<B>-append</B> フラグを使用します。付加ダンプの場合、バックアップ・システムは次の条件を前提とします。
<UL>
<LI>磁気テープに書き込む場合は、テープ・コーディネーターは、バックアップ・データベースに存在する完全で有効な磁気テープおよびダンプ・レコードに対するダンプ・セットの最後のダンプであるか検査します。そうでない場合は、テープ・コーディネーターは磁気テープを拒絶し、正しい磁気テープを要求します。
<B>backup scantape</B> コマンドに <B>-dbadd</B> 引き数を付けて発行すると、データベースに必要なレコードを挿入することができます。
</LI><LI>磁気テープ上、またはバックアップ・データ・ファイルの最新のダンプは、正常に完了していなければなりません。
</LI><LI>ダンプ・セットは、バックアップ・データベースに記録されている初期ダンプで開始していなければなりません。磁気テープ上にダンプがないと、バックアップ・システムは、初期ダンプとみなし、初期ダンプの要件 (たとえば、
AFS 磁気テープ名の検査など) を前提としてダンプ操作を行います。
</LI></UL>
<P>複数のダンプ操作をスケジュールする場合には、
<B>-file</B> 引き数で指定したファイルに、操作をリストします。必要であれば、<B>-at</B> 引き数を使用して、
<B>backup</B> コマンド・インタープリターがファイルを読み取る時刻を指定することができます。この引き数を使用しないと、すぐにファイルの読み取りが開始します。
<B>-file</B> 引き数は、このコマンドの最初の 3 つの引き数、<B>-append</B>、または <B>-n</B> フラグと一緒に使用することはできません。ファイルに指定するコマンドでは、
<B>backup dump</B> コマンドのどの引き数でも使用することができます。
<B>-at</B> 引き数を使用して、ダンプを後で実行するようにスケジュールすることもできます。
<P>ダンプに含まれているボリュームのリストを生成するには、実際にボリュームをダンプしないで、
<B>-n</B> フラグを実際のコマンドで使用されるオプションと組み合わせてください。
<P><B>バックアップ・システムによるダンプ操作の実行方法</B>
<P>ダンプ操作を開始する前に、バックアップ・システムは、ボリューム・セット、ダンプ・レベル、およびポート・オフセットの項目がバックアップ・データベースにあるかどうか検査します。コマンドの構文が正しく、対話モードで発行されていれば、このコマンドにジョブ番号を割り当て、ジョブ・リストに追加します。
<B>(backup) jobs</B> コマンドを使用すると、対話モードでジョブ・リストを表示することができます。終了する場合には、
<B>(backup) kill</B> コマンドを使用します。
<P>ボリューム・ロケーション・サーバー (VL) から、ダンプするボリュームのリストを取得した後で、バックアップ・サーバーはそのリストをサイト (サーバーと区画) 別にソートします。バックアップ・サーバーは、同じサイトのボリュームをダンプ内でグループにまとめ、復元操作中にオペレーターが磁気テープを交換する回数を最小化します。
<P>インクリメンタル・ダンプはその親に依存しているので、有効な親ダンプが存在していないと、バックアップ・システムはその子であるインクリメンタル・ダンプを作成することができません。すぐ上の親ダンプ・レベルで作成されたダンプ・レコードが検出できないと、バックアップ・システムは、階層内で 1 つ上のレベルで作成されたダンプがないかどうかバックアップ・データベースを検索します。レコードが検出できないと、この操作をフル・ダンプ・レベルまで繰り返し行います。有効な親ダンプ・セットが検出できると、その 1 つ下のレベルにインクリメンタル・ダンプを作成します。フル・ダンプ・レベルでも検出できない場合には、そのボリューム・セットのダンプをフル・ダンプ・レベルで作成します。
<P>ダンプ操作中にボリュームにアクセス不能になると、バックアップ・システムはそのボリュームをスキップし、ボリューム・セットの残りのボリュームのダンプを作成します。サーバー・マシンまたはプロセスが停止したり、ボリューム・ロケーション (VL) サーバーがボリューム・セットのボリュームにサイト・リストを生成してから、そのボリュームのデータのダンプを開始するまでにボリュームが移動していると、ボリュームにアクセスできない状態になります。最初のダンプ操作が終了すると、バックアップ・システムはスキップしたボリュームのダンプを再試行します。それでもボリュームをダンプできず、
<B>CFG_</B><VAR>device_name</VAR> ファイルに <B>ASK NO</B> 命令が表示されない場合、バックアップ・システムは、ボリュームのダンプを再試行するのか、ダンプからボリュームを省略するのか、あるいは、操作をすべて停止する必要があるかどうかを、オペレーターに照会します。プロンプトが表示されたときに、操作員は、バックアップ・システムがボリュームにアクセスできなかった原因を解決することができます。
<B>CFG_</B><VAR>device_name</VAR> ファイルに <B>ASK NO</B> 命令があると、バックアップ・システムはそのボリュームをダンプから削除します。
<P>ダンプ操作をスケジュールする前に、バックアップ・システムは、
<B>-at</B> 引き数に指定された日付が経過していないかどうか検査し、通常のダンプ操作と同じように、ボリューム・セット、ダンプ・レベル、およびポート・オフセットの妥当性を検査します。スケジュールした操作を実行する前にも、パラメーターの妥当性を再度検査します。
<P>ラベルに永続名がない磁気テープに初期ダンプを書き込む前に、バックアップ・システムは、ラベルの AFS 磁気テープ名が有効かどうか検査します。必要であれば、<B>CFG_</B><VAR>device_name</VAR> ファイルで <B>NAME_CHECK NO</B> 命令を指定して、名前の検査を使用不可にしてください。
<P>AFS 磁気テープ名の検査が使用可能な場合、バックアップ・システムは、次の 3 つのタイプの値を AFS 磁気テープ名として受け入れます。ラベル名が正しくない場合、バックアップ・システムは、
<B>CFG_</B><VAR>device_name</VAR> ファイルの <B>MOUNT</B> 命令を呼び出すか、操作員にプロンプトを出して、有効なラベルを持つ磁気テープを獲得します。
<OL TYPE=1>
<LI><VAR>volume_set_name.dump_level_name.tape_index</VAR> という形式の名前。
<VAR>volume_set_name</VAR> は <B>-volumeset</B> 引き数の値、
<VAR>dump_level_name</VAR> は、<B>-dump</B> 引き数のパス名値の最後の要素、
<VAR>tape_index</VAR> は、複数テープ・ダンプ・セットでのテープの位置です。たとえば、ダンプ・レベル <B>/sunday2/monday</B> のボリューム・セット <B>user</B> に初期ダンプがあり、そのダンプ・セットの最初の磁気テープに <B>user.monday.1</B> という AFS 名が付いている場合、このタイプの AFS 磁気テープ名がラベルに記録されていれば、バックアップ・システムは AFS 磁気テープ名を保存し、その磁気テープにダンプを書き込みます。
</LI><LI><TT>&lt;NULL></TT>。この文字列は、磁気テープのラベル作成に使用された <B>backup labeltape</B> コマンドで、
<B>-name</B> 引き数に AFS 磁気テープ名が指定されていないことを表しています。あるいは、<B>-pname</B> 引き数に親名が指定されていません。ラベルに <TT>&lt;NULL></TT> 値が記録されると、バックアップ・システムは、適切な AFS 磁気テープ名を構成してラベルに記録し、磁気テープにダンプを書き込みます。
</LI><LI>バックアップ・システムは、磁気テープのラベルを作成したり、磁気テープを使用しないので、値はまったくありません。
AFS 磁気テープ名が <TT>&lt;NULL></TT> の場合、バックアップ・システムは、適切な AFS 磁気テープ名を構成してラベルに記録し、磁気テープにダンプを書き込みます。
</LI></OL>
<P>磁気テープに書き込めるデータ量を判別するために、テープ・コーディネーターは、磁気テープのラベルに記録された容量を読み取ります。
(<B>backup labeltape</B> コマンドの <B>-size</B> 引き数を使用します。)
ラベルの容量フィールドが空になっていると、テープ・コーディネーターは、ローカルの <B>tapeconfig</B> ファイルを参照して、指定されたポート・オフセットに記録された容量を使用します。
<B>tapeconfig</B> ファイルの容量フィールドも空である場合、テープ・コーディネーターは最大容量の 2 TB を使用します。
<P>ダンプ操作時に、テープ・コーディネーターは、書き込んだデータの量を記録し、磁気テープの容量に達する直前に、書き込みを停止します。データの書き込みの途中で磁気テープ容量に達した場合には、データの続きを表す特別なマーカーを書き込み、次の磁気テープを使用して、ボリュームの書き込みを継続します。このボリュームの分割は、初期ダンプの場合でも、付加ダンプの場合でも発生します。この場合、ボリュームが複数の磁気テープに分散していることが、バックアップ・データベースに自動的に記録されます。
<P>磁気テープの容量が予期した容量よりも大きい場合、テープ・コーディネーターは、次の磁気テープを使用しません。磁気テープの容量が予期した容量よりも小さい場合、テープ・コーディネーターは、データの書き込み中に予期しないテープ終わりマーカー (EOT) を検出する場合があります。ボリューム・データの書き込み中であれば、テープ・コーディネーターは、新しい磁気テープを獲得し、中断したボリュームのすべての内容を再度書き込みます。前の磁気テープに書き込まれたボリューム・データはそのまま残りますが、使用されることはありません。
<P>バックアップ・システムは、磁気テープの再利用 (不要になった古いダンプ・セットの上から新しいダンプ・セットを書き込むこと) を許可していますが、その場合、次の条件を満たしていなければなりません。
<UL>
<LI>古いダンプ・セット内のダンプの有効期限がすべて切れていなければなりません。バックアップ・システムは、常に有効期限の検査を行っています。名前の検査が使用不可の場合でも検査します。
</LI><LI>再利用する磁気テープに永続名がなく、名前の検査が使用可能な場合には、新しい初期ダンプのボリューム・セット名から発生した AFS 磁気テープ名とラベルに記録されている AFS 磁気テープ名が一致していなければなりません。
</LI><LI>この磁気テープには、現在ダンプ中のデータは書き込めなくなっています。これは、操作員または自動磁気テープ装置がドライブから前の磁気テープを取り外していないか、間違ってドライブに再挿入されていることを想定しているためです。テープ・コーディネーターは、次のメッセージを生成して、別の磁気テープの挿入を要求します。
<P>
<PRE>   作成中のダンプを含む磁気テープを上書きすることはできません

</PRE>
</LI><LI>この磁気テープには、現在のダンプ (インクリメンタル・ダンプ) の親ダンプのデータは書き込まれません。親ダンプを上書きすると、現在のダンプからデータが復元できなくなるためです。テープ・コーディネーターは、次のメッセージを生成して、別の磁気テープの挿入を要求します。
<P>
<PRE>   親ダンプを上書きすることはできません<VAR>parent_name</VAR> (<VAR>parent_dump_ID</VAR>)

</PRE>
</LI></UL>
<P>すべてのダンプが有効期限切れになる前か、あるいは AFS 磁気テープ名が間違っているときに磁気テープを再利用する場合には、
<B>backup labeltape</B> コマンドを発行して、磁気テープのラベルを無効にし、関連する磁気テープおよびダンプ・レコードをバックアップ・データベースからすべて削除してください。
<P>このコマンドを実行すると、デフォルトでは、テープ・コーディネーターは、
<B>/CFG_</B><VAR>device_name</VAR> ファイルの <B>MOUNT</B> 命令を呼び出して、最初の磁気テープにアクセスします。<B>MOUNT</B> 命令がない場合には、磁気テープの挿入をバックアップ操作員に要求します。ただし、<B> CFG_</B><VAR>device_name</VAR> ファイルに <B>AUTOQUERY NO</B> 命令があるか、あるいは <B>butc</B> コマンドが <B>-noautoquery</B> フラグ付きで発行されている場合には、テープ・コーディネーターは、磁気テープがすでに装置に挿入されているとみなします。そうでない場合、テープ・コーディネーターは
<B>MOUNT</B> 命令を呼び出すか、操作員にプロンプトを出します。また、ダンプ操作で別の磁気テープが必要になった場合も、
<B>MOUNT</B> 命令を呼び出すか、プロンプトを出します。この場合、発行者は、必要な磁気テープを挿入しなければなりません。
<P><STRONG>注意</STRONG>
<P>何らかの理由で、ダンプ操作が中断したか、失敗した場合は、割り込み前に磁気テープに書き込まれたすべのボリュームからのデータは有効で、復元操作に使用することができます。バックアップ・データベースには、失敗したダンプと正常にダンプされた各ボリュームに対する項目が含まれます。ダンプ操作が中断した場合の情報については、<I>AFS 管理の手引き</I> を参照してください。
<P>バックアップ・データ・ファイルではなく、磁気テープにダンプする場合は、互換性のある磁気テープ装置 (同じタイプの磁気テープを読み取れる装置) だけを使用するのが最もよい方法です。互換性のある装置を使用すると、復元操作が非常に単純化されます。
<B>backup diskrestore</B> および <B>backup volsetrestore</B> コマンドの <B>-portoffset</B> 引き数には、複数のポート・オフセット番号を指定できます。ただし、バックアップ・システムは、すべてのフル・ダンプを復元する場合には、最初にリストされたポート・オフセット番号、すべてのレベル 1 のダンプを復元する場合は、2 番目にリストされたポート・オフセット番号、というようにポート・オフセット番号を使用していきます。最も低いレベルで、互換性のある磁気テープ装置を使用して、各レベルでのダンプを実行してください。互換性のない磁気テープ装置がない場合には、
<B>backup volrestore</B> コマンドを使用して、
1 回に 1 つのボリュームを復元するようにしてください。
<P><B>backup</B> コマンド・インタープリターは、
<B>-file</B> 引き数に指定されたファイルを読み取るとき、およびファイルにリストされた各操作を実行するときに、有効な (期限の切れていない) 管理トークンが必要になります。たとえば、操作員の不在時にダンプを実行するように発行者でスケジューリングした場合には、そのローカル・マシンで使用可能で有効なトークンが必要になります。これに対する 1 つのオプションは、ファイル・サーバー・マシン上ですべてのコマンドを発行 (または、すべてのスクリプトを実行) し、
<B>backup</B> および <B>vos</B> コマンドに <B>-localauth</B> フラグを指定することです。マシンまたはトークンに対する不正なアクセスを防ぐために、マシンは物理的に保護されていなければなりません。
(たとえば、操作時に操作員が監視しているテープ・コーディネーター・マシンよりも厳しく保護しなければなりません。)
また、操作員不在時にダンプに複数の磁気テープが必要になった場合、操作員は、磁気テープ・スタッカーまたはジュークボックスと、装置構成ファイルを正しく設定しなければなりません。
<P>通常モード (非対話モード) でコマンドを発行すると、ダンプ操作が完了するまで、シェル・プロンプトに制御は戻りません。新たに接続をオープンしなくても済むようにするには、対話モードでコマンドを発行してください。特に <B>-at</B> 引き数を指定してダンプ操作をスケジュールする場合には、そのようにしてください。
<P><STRONG>オプション </STRONG>
<DL>
<P><DT><B>-volumeset
</B><DD>ダンプを作成するボリューム・セット名を指定します。この名前は <B>-dump</B> 引き数にも指定してください。これらの引き数は、<B> -file</B> 引き数と一緒に使用してはなりません。一時ボリューム・セットを使用する場合は、
<B>-temporary</B> フラグの付いた <B>backup addvolset</B> コマンドが出された対話式セッション内で、
<B>vos dump</B> コマンドを出す必要があります。
<P><DT><B>-dump
</B><DD>ボリューム・セットのダンプを作成するダンプ・レベルの完全なパス名を指定します。この名前は <B>-volumeset</B> 引き数にも指定してください。これらの引き数は、<B> -file</B> 引き数と一緒に使用してはなりません。
<P><DT><B>-portoffset
</B><DD>この操作で磁気テープを処理するテープ・コーディネーターのポート・オフセット番号を指定します。この番号を指定しないと、デフォルトで 0 (ゼロ) が使用されます。この引き数は、<B>-file</B> 引き数と一緒に使用してはなりません。
<P><DT><B><B>-at</B>
</B><DD>コマンドを実行する日時または <B>-file</B> 引き数で指定されたファイルを読み取る日時を指定します。現在の日付よりも後の値を指定してください。値は、<VAR>mm/dd/yyyy</VAR> [<VAR>hh:MM</VAR>] の形式で指定してください。月 (<VAR>mm</VAR>)、日 (<VAR>dd</VAR>)、および年 (<VAR>yyyy</VAR>) は必須です。年に指定できる値は、
<B>1970</B> から <B>2037</B> までです。
UNIX の標準表記では 2038 年 2 月までしか表現できないので、
2037 より大きな値は無効になります。バックアップ・システムは、それ以降の日付を自動的に最大値に変更します。
<P>
<P>時間と分 (<VAR>hh:MM</VAR>) はオプションです。ただし、指定する場合には、24 時間形式で指定してください。
(たとえば、2:36 p.m. は、<B>14:36</B> とします)
この値を省略すると、デフォルトで、午前 0 時 (00:00) が使用されます。
<P>
<P>たとえば、値 <B>04/23/1999 20:20</B> を指定すると、
1999 年 4 月 23 日の午後 8 時 20 分にコマンドが実行されます。
<P>
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">コマンドの構文ステートメントは、二重引用符や他の区切り記号で囲む必要のない複数語の値を受け入れるため、その中にあるこの引き数には、正符号 (+) が付きます。このステートメントが複数日付を受け入れるからではありません。日付 (任意選択で、時刻) 定義は、1 つだけ指定してください。
</TD></TR></TABLE>
<P><DT><B>-append
</B><DD>別のダンプのデータが入っている磁気テープの終わりにダンプを追加します。ただし、この磁気テープが既存のダンプ・セットの一部でない場合、バックアップ・システムは、このダンプのパラメーターを使用して、新規のダンプ・セットを作成します。この磁気テープがダンプ・セットの最後のテープでない場合、テープ・コーディネーターは、プロンプトを出して、別の磁気テープの挿入を要求します。この引き数は、<B>-file</B> 引き数と一緒に使用してはなりません。
<P><DT><B>-n
</B><DD>指定されたダンプに含まれるボリューム名を表示します。実際のダンプ操作は行いません。この引き数は、<B>-file</B> 引き数と一緒に使用してはなりません。
<P><DT><B>-file
</B><DD><B>backup</B> コマンドのあるローカル・ディスクまたは AFS パス名を指定します。このファイルは、<B>-at</B> 引き数が指定されていれば、その時刻に、そうでなければ即時に読み込まれます。部分パス名を指定すると、現行作業ディレクトリーとの相対位置で解釈されます。
<P>
<P>各 <B>backup dump</B> コマンドは、指定したファイルの各行に、コマンド行の場合と同じ構文で記述してください。ただし、行の先頭に <B>backup</B> を付ける必要はありません。各コマンドには、<B>-volumeset</B> および <B> -dump</B> 引き数の値を指定してください。デフォルトの 0 を使用しない場合には、
<B>-portoffset</B> 引き数にも値を指定してください。ファイルには、<B>backup dump</B> コマンドのオプションのオプションも指定することができます。次のファイルの例では、バックアップ・システムがファイルを読み込むとすぐに最初のコマンドが実行され、他のコマンドは、ファイルの読み込みが開始した後で実行されるようにスケジュールされています。
<P>
<PRE>   dump user /sunday1/wednesday -port 1
   dump sun4x_56 /sunday1/friday -port 2 -at 04/08/1999
   dump sun4x_55 /sunday1/friday -port 2 -at 04/08/1999 02:00 -append

</PRE>
<P>
<P>
<P>この引き数は、<B>-volumeset</B>、
<B>-dump</B>、<B>-portoffset</B>、
<B>-append</B>、または <B>-n</B> オプションと一緒に使用してはなりません。
<P><DT><B>-localauth
</B><DD>ローカルの <B>/usr/afs/etc/KeyFile</B> ファイルのキーを使用して、サーバー・チケットを構成します。相互認証の間、
<B>backup</B> コマンド・インタープリターは、バックアップ・サーバー、ボリューム・サーバーおよび VL サーバーにこのチケットを提供します。このフラグは、<B>-cell</B> 引き数と一緒に使用してはなりません。詳細については、<B>backup</B> の解説ページを参照してください。
<P><DT><B>-cell
</B><DD>コマンドを実行するセルを指定します。この引き数は、
<B>-localauth</B> フラグと一緒に使用してはなりません。詳細については、<B>backup</B> の解説ページを参照してください。
<P><DT><B>-help
</B><DD>このコマンドのオンライン・ヘルプを出力します。これ以外の有効なオプションはすべて無視されます。
</DL>
<P><STRONG>出力</STRONG>
<P>コマンド・インタープリターは、まず、ボリューム・セットの項目とボリューム・ロケーション・データベース (VLDB) にあるボリュームを突き合わせて、ダンプに含まれるボリュームのリストを生成します。次のヘッダーを出力します。
<PRE>   Preparing to dump the following volumes:

</PRE>
<P>次に、以下のメッセージを出力して、処理を行うテープ・コーディネーターにダンプ要求を送信したことを示します。
<PRE>ダンプを開始しています。

</PRE>
<P>発行者が <B>-n</B> フラグを使用している場合には、次のような形式の出力になります。
<PRE>   Starting dump of volume set '<VAR>volume set</VAR>' (dump set '<VAR>dump level</VAR>')
   Total number of volumes : <VAR>number dumped</VAR>
   Would have dumped the following volumes:
   <VAR>list_of_volumes</VAR>

</PRE>
<P><VAR>list_of_volumes</VAR> は、各ボリュームを名前とボリューム ID 番号で識別します。
<P>テープ・コーディネーターがボリュームにアクセスできなくなると、テープ・コーディネーターはウィンドウにエラー・メッセージを表示し、ログとエラー・ファイルにエラーを記録します。
<P><STRONG>例</STRONG>
<P>次のコマンドは、<B>user</B> というボリューム・セットのボリュームのダンプをダンプ・レベル <B>/full/sunday2/monday</B> で作成しています。発行者は、必要な磁気テープをポート・オフセット 5 の装置に挿入しています。
<PRE>   % <B>backup dump -volumeset user -dump /full/sunday2/monday -portoffset 5</B>
   Preparing to dump the following volumes:
   user.jones.backup   387623900
   user.pat.backup     486219245
   user.smith.backup   597315841
           .                .
           .                .
   Starting dump.

</PRE>
<P>次のコマンドは、ユーザーが <B>sys_sun</B> ボリューム・セットのダンプを <B>/full</B> ダンプ・レベルで作成するときに、ダンプに含まれるボリュームのリストを表示します。
<PRE>   % <B>backup dump -volumeset sys_sun -dump /full -n</B>
   Starting dump of volume set 'sys_sun' (dump set '/full')
   Total number of volumes: 24
   Would have dumped the following volumes:
   sun4x_56      124857238
   sun4x_56.bin  124857241
        .            .
        .            .
   sun4x_55      124857997
        .            .
        .            .

</PRE>
<P>次のコマンドは、ボリューム・セット <B>user</B> のボリュームのダンプをダンプ・レベル <B>/sunday2/monday1</B> で 1999 年 6 月 14 日 午後 11 時 00 分に実行するようにスケジュールしています。該当するテープ・コーディネーターのポート・オフセットは 0 (ゼロ) なので、この引き数は省略されています。
<PRE>   % <B>backup dump -volumeset user -dump /sunday2/monday1 -at 06/14/1999 23:00</B>

</PRE>
<P><STRONG>必要となる特権</STRONG>
<P>コマンドの発行者は、バックアップ・サーバーまたはボリューム・ロケーション (VL) サーバーが実行されている各マシン上、および関連するボリュームのあるすべてのファイル・サーバー・マシン上の <B>/usr/afs/etc/UserList</B> ファイルにリストされていなければなりません。
<B>-localauth</B> フラグを使用する場合には、コマンドの発行者が、ローカル・スーパーユーザー <B>root</B> として、サーバー・マシンにログオンする必要があります。
<P><STRONG>関連情報 </STRONG>
<P><A HREF="auarf060.htm#HDRBK_INTRO">backup</A>
<P><A HREF="auarf061.htm#HDRBK_ADDDUMP">backup adddump</A>
<P><A HREF="auarf063.htm#HDRBK_ADDVOLENTRY">backup addvolentry</A>
<P><A HREF="auarf064.htm#HDRBK_ADDVOLSET">backup addvolset</A>
<P><A HREF="auarf072.htm#HDRBK_DISKRESTORE">backup diskrestore</A>
<P><A HREF="auarf079.htm#HDRBK_LABELTAPE">backup labeltape</A>
<P><A HREF="auarf091.htm#HDRBK_VOLRESTORE">backup volrestore</A>
<P><A HREF="auarf126.htm#HDRBUTC">butc</A>
<P>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auarf072.htm">前ページ</A> &#124; <A HREF="auarf074.htm">次ページ</A> &#124; <A HREF="auarf002.htm#ToC">目次</A> &#124; <A HREF="auarf284.htm#HDRINDEX">索引</A> &#93;</B>
<!-- Begin Footer Records  ========================================== -->
<P><HR><B>
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved
</B>
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>

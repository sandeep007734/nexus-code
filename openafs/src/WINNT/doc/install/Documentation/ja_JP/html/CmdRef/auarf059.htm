<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理解説書</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- C:\IDWB\TEMP\idwt1068\AUARF000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 21:46:04            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 21:46:02">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 21:46:02">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 21:46:02">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    -->
<BODY bgcolor="ffffff">
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理解説書</H1>
<P>
<H2><A NAME="HDRAFSMONITOR" HREF="auarf002.htm#ToC_73">afsmonitor</A></H2>
<P><STRONG>目的</STRONG>
<P>ファイル・サーバーおよびキャッシュ・マネージャーをモニターします。
<P><STRONG>構文</STRONG>
<PRE><B>afsmonitor</B> [<B>initcmd</B>]  [<B>-config</B> &lt;<VAR>configuration file</VAR>>]
           [<B>-frequency</B> &lt;<VAR>poll frequency, in seconds</VAR>>]
           [<B>-output</B> &lt;<VAR>storage file name</VAR>>]  [<B>-detailed</B>]
           [<B>-debug</B> &lt;<VAR>turn debugging output on to the named file</VAR>>]
           [<B>-fshosts</B> &lt;<VAR>list of file servers to monitor</VAR>><SUP>+</SUP>]
           [<B>-cmhosts</B> &lt;<VAR>list of cache managers to monitor</VAR>><SUP>+</SUP>]
           [<B>-buffers</B> &lt;<VAR>number of buffer slots</VAR>>]  [<B>-help</B>]

<B>afsmonitor</B> [<B>i</B>]  [<B>-co</B> &lt;<VAR>configuration file</VAR>>]
           [<B>-fr</B> &lt;<VAR>poll frequency, in seconds</VAR>>]
           [<B>-o</B> &lt;<VAR>storage file name</VAR>>]  [<B>-det</B>]
           [<B>-deb</B> &lt;<VAR>turn debugging output on to the named file</VAR>>]
           [<B>-fs</B> &lt;<VAR>list of file servers to monitor</VAR>><SUP>+</SUP>]
           [<B>-cm</B> &lt;<VAR>list of cache managers to monitor</VAR>><SUP>+</SUP>]
           [<B>-b</B> &lt;<VAR>number of buffer slots</VAR>>]  [<B>-h</B>]
</PRE>
<P><STRONG>構文</STRONG>
<P><B>afsmonitor</B> コマンドは、特定のファイル・サーバーとキャッシュ・マネージャーの操作についての統計を集めて表示するプログラムを初期化します。このコマンドを使うと、発行者は、単一のロケーションから、広い範囲のファイル・サーバーとキャッシュ・マネージャーの操作を、モニターすることができます。この場合、何台のマシンで実行されていても、ローカルと外部セルの両方でモニターすることができます。
<P>ファイル・サーバーの場合、統計は 271 で、キャッシュ・マネージャーの場合は 570 です。これらは、<I>AFS 管理の手引き</I> の <B>afsmonitor</B> 統計についての付録にリストされています。デフォルトではこのコマンドは、
<B>-fshosts</B> 引き数で指定されたファイル・サーバー・マシンと、
<B>-cmhosts</B> 引き数で指定されたクライアント・マシンの関連統計をすべて表示します。重要な統計だけを表示するように制限を設けるには、
<B>-config</B> 引き数に指定する構成ファイルに、表示したい統計だけをリストします。さらに、構成ファイルは、以下のような目的で使用します。
<UL>
<LI>任意のモニター統計に対するしきい値を設定する。統計値がしきい値を超えた時、<B>afsmonitor</B> コマンドは、その値を反転表示で表示します。デフォルトのしきい値はありません。
</LI><LI>統計がそのしきい値を超える場合に、プログラムまたはスクリプトを自動的に呼び出す。
AFS 分散は、任意のスクリプトを組み込みません。
</LI><LI><B>-fshosts</B> 引き数や <B>-cmhosts</B> 引き数を使用する代わりに、モニターするファイル・サーバーおよびクライアント・マシンをリストする。
</LI></UL>
<P>構成ファイルの説明については、<B>afsmonitor 構成ファイル</B>の解説ページを参照してください。
<P><STRONG>注意</STRONG>
<P>次のソフトウェアが、
<B>afsmonitor</B> プログラムを実行中のマシンにアクセスできるようになっている必要があります。
<UL>
<LI><B>afsmonitor</B> プログラムがデータ収集に使用する、
AFS <B>xstat</B> ライブラリー
</LI><LI>ほとんどの UNIX 分散で、標準ユーティリティーとして提供されている、
<B>curses</B> グラフィックス・パッケージ
</LI></UL>
<A NAME="IDX4198"></A>
<A NAME="IDX4199"></A>
<P><B>afsmonitor</B> 画面は、いわゆるダム端末と端末をエミュレートするウィンドウ内操作システムの両方で、正常に形式化されます。モニター環境では、出力が最も良く表示されるように、反転表示およびカーソル・アドレス指定がサポートされていなければなりません。
TERM 環境変数を正しい端末タイプに設定するか、実際の端末タイプに類似した特性を持つ値に設定します。表示ウィンドウまたは表示端末は、少なくとも表示幅が 80 列で、表示行数が 12 行でなければなりません。
<A NAME="IDX4200"></A>
<A NAME="IDX4201"></A>
<A NAME="IDX4202"></A>
<P><B>afsmonitor</B> プログラムは、それ自身の独立した専用ウィンドウまたは端末のフォアグラウンドで実行されなければなりません。ウィンドウまたは端末は、<B>afsmonitor</B> が実行されている間は、他の活動に使用できません。
<B>afsmonitor</B> プログラムのインスタンスは、各インスタンスが独自の専用ウィンドウや端末で実行している限り、単一マシンでいくつでも実行することができます。追加したインスタンスを開始するのに 3 分かかることがあるので注意してください。
<P><STRONG>オプション </STRONG>
<DL>
<P><DT><B>initcmd
</B><DD>コマンドの AFS コマンド・パーサーの使用状況を調べます。これはオプションです。
<P><DT><B>-config
</B><DD>モニターするマシン、表示する統計、あれば、しきい値をリストする構成ファイルを指定します。相対パス名は、現行作業ディレクトリーを起点にして解釈されます。
<B>-fshosts</B> 引き数または <B>-cmhosts</B> 引き数のいずれか、あるいはどちらも指定しない場合に、この引き数を指定します。このファイルの作成方法については、前述の [<B>説明</B>] セクションと <I>AFS 管理の手引き</I> の <B>afsmonitor</B> プログラムのセクションを参照してください。
<P><DT><B>-frequency
</B><DD><B>afsmonitor</B> プログラムがファイル・サーバーとキャッシュ・マネージャーをプローブするかを、秒単位で指定します。有効な値の範囲は、
<B>1</B> から <B>86400</B> (24 時間) です。デフォルト値は、<B>60</B> です。この頻度は、ファイル・サーバーとキャッシュ・マネージャーの両方に適用されますが、
<B>afsmonitor</B> プログラムは、2 つのタイプのプローブを開始し、それらの結果を別々に処理します。ホストへのプローブ間の実際のインターバルは、頻度に応答するすべてのホストのために必要とされる時間を加えてプローブされます。
<P><DT><B>-output
</B><DD><B>afsmonitor</B> が収集するすべての統計を書き込むファイル名を指定します。デフォルトでは、作成された出力ファイルはありません。
<I>AFS 管理の手引き</I> にある <B>afsmonitor</B> コマンドのセクションを参照してください。このファイルに情報があります。
<P><DT><B>-detailed
</B><DD><B>-output</B> 引き数で指定された出力ファイルの情報を、最も読みやすいように書式化します。この値といっしょに <B>-output</B> 引き数を与えます。
<P><DT><B>-fshosts
</B><DD>収集するファイル・サーバーの統計から 1 つ以上のマシンの名前を指定します。それぞれのマシンごとに、完全修飾ホスト名か明確な省略形のいずれかを指定してください (省略形の解析能力は、コマンドが出されたときのセル名サービスの状態によって異なります)。この引き数は、<B>-config</B> 引き数とでなく、
<B>-cmhosts</B> 引き数と組み合わせることが可能です。
<P><DT><B>-cmhosts
</B><DD>収集するキャッシュ・マネージャーの統計から 1 つ以上のマシンの名前を指定します。それぞれのマシンごとに、完全修飾ホスト名か明確な省略形のいずれかを指定してください (省略形の解析能力は、コマンドが出されたときのセル名サービスの状態によって異なります)。この引き数は、<B>-config</B> 引き数とでなく、
<B>-fshosts</B> 引き数と組み合わせることが可能です。
<P><DT><B>-buffers
</B><DD>機能しません。将来におけるプログラムの拡張に備えて提供されます。
<P><DT><B>-help
</B><DD>このコマンドのオンライン・ヘルプを出力します。これ以外の有効なオプションはすべて無視されます。
</DL>
<P><STRONG>出力</STRONG>
<P><B>afsmonitor</B> プログラムは、3 つの画面にデータを表示します。
<UL>
<LI>[<TT>システム概説</TT>]: <B>afsmonitor</B> プログラムの初期化時に、自動的に表示されます。ファイル・サーバーおよびキャッシュ・マネージャーについて、モニターされているマシンの数と、それらのうちいくつに<I>アラート</I>が出されている (統計がしきい値を超えている) かを、別々に合計します。その後、モニターされているマシンごとに、ホスト名とアラートの回数がリストされ、適宜、プロセスが最後のプローブへの応答に失敗したことを示します。
</LI><LI>[<TT>ファイル・サーバー</TT>]: モニターされているファイル・サーバー・マシンごとのファイル・サーバー統計を表示します。しきい値を超えている統計を強調表示し、最後のプローブへの応答に失敗したマシンを識別します。
</LI><LI>[<TT>キャッシュ・マネージャー</TT>]: モニターされているクライアント・マシンごとにキャッシュ・マネージャー統計を表示します。しきい値を超えている統計を強調表示し、最後のプローブへの応答に失敗したマシンを識別します。
</LI></UL>
<P>各画面の角にあるフィールドには、次の情報が表示されます。
<UL>
<LI>左上の角には、プログラム名およびバージョン番号。
</LI><LI>右上の角には、画面名、現行ページ番号および合計ページ数、現行列番号および合計列数。ページ番号 (たとえば、<TT>p. 1 of 3</TT>) は、データが表示されている現行ページのインデックスと合計ページ数 (垂直) を示します。列番号 (たとえば、<TT>c. 1 of 235</TT>) は、データが表示されている現行の左端の列のインデックスと合計列数を示します。
(記号 <TT>&gt;&gt;&gt;</TT> は、右に追加データがあることを示しています。記号 <TT>&lt;&lt;&lt;</TT> は、左に追加データがあることを示しています。)
</LI><LI>左下の角には、使用可能なコマンドのリストが表示されます。コマンド名の先頭文字を入力することで、そのコマンドを実行できます。現在可能なオプションだけが表示されます。たとえば、データが 1 ページ分だけしかない場合、それぞれ画面を上下にスクロールする <TT>next</TT> および <TT>prev</TT> コマンドは、表示されません。コマンドの説明については、表示画面のナビゲートに関する次のセクションを参照してください。
</LI><LI>右下の角には、<TT>probes</TT> フィールドがあり、プログラムがファイル・サーバー (<TT>fs</TT>)、キャッシュ・マネージャー (<TT>cm</TT>)、またはその両方を何回プローブしたかを報告します。ファイル・サーバーとキャッシュ・マネージャーのカウント数は、異なることがあります。
<TT>freq</TT> フィールドは、プログラムがプローブを送信する頻度を報告します。
</LI></UL>
<P><B>afsmonitor 表示画面のナビゲート</B>
<P>注にあるように、それぞれの表示画面の左下角には、代替画面への移動に現在使用可能なコマンド名が表示されます。代替画面は、異なるタイプ、またはより多くの統計の表示、あるいは現行タイプのマシンです。コマンドを実行するには、小文字バージョンの名前の最初の文字を押します。コマンドによっては、次のリストにあるように、多少機能が異なる大文字バージョンがあります。
<DL>
<P><DT><B><TT>cm</TT>
</B><DD>[<TT>キャッシュ・マネージャー</TT>] 画面に切り替えます。
[<TT>システム概説</TT>] と [<TT>ファイル・サーバー</TT>] 画面でのみ使用可能です。
<P><DT><B><TT>fs</TT>
</B><DD>[<TT>ファイル・サーバー</TT>] 画面に切り替えます。
[<TT>システム概説</TT>] と [<TT>キャッシュ・マネージャー</TT>] 画面でのみ使用可能です。
<P><DT><B><TT>left</TT>
</B><DD>現行セットの左にあるデータ列にアクセスするために、左にスクロールします。
<TT>&lt;&lt;&lt;</TT> 記号が画面左上に表示されているときに、使用可能です。英大文字の <B>L</B> を押して、左端まで横にスクロールします (データ列の最初のセットを表示)。
<P><DT><B><TT>next</TT>
</B><DD>次のページのマシン名まで、縦方向にスクロールダウンします。
2 ページ分以上のマシンがあり、最終ページが現在表示されているときに、使用可能です。英大文字の <B>N</B> を押して、最終ページへスクロールします。
<P><DT><B><TT>oview</TT>
</B><DD>[<TT>システム概説</TT>] 画面に切り替えます。
[<TT>キャッシュ・マネージャー</TT>] および [<TT>ファイル・サーバー</TT>] 画面でのみ使用可能です。
<P><DT><B><TT>prev</TT>
</B><DD>直前のページのマシン名まで、縦方向にスクロールアップします。
2 ページ分以上のマシンがあり、最初のページが現在表示されているときに、使用可能です。英大文字の <B>N</B> を押して、最初のページへスクロールします。
<P><DT><B><TT>right</TT>
</B><DD>現行セットの右にあるデータ列にアクセスするために、右にスクロールします。このコマンドは、画面右上に <TT>>>></TT> 記号が表示されているときに、使用可能です。英大文字の <B>R</B> を押して、右端まで横にスクロールします (データ列の最終セットを表示)。
</DL>
<P><B>システム概説画面</B>
<P>[<TT>システム概説</TT>] 画面は、
<B>afsmonitor</B> プログラムの初期化時に自動的に表示されます。この画面には、現行ウィンドウに収まる数のファイル・サーバーとキャッシュ・マネージャー・プロセスの状況が表示されます。スクロールダウンすると、追加情報にアクセスすることができます。
<P>この画面上の情報は、左側のファイル・サーバー情報と、右側のキャッシュ・マネージャー情報に分割されます。各グループの見出しには、次の 2 つの情報が報告されます。
<UL>
<LI>指定されたプロセスを、プログラムがモニターしているマシンの数
</LI><LI>アラートの回数とそれらによって影響を受けたマシンの数。
(<I>アラート</I> は、統計がしきい値を超えていたり、プロセスが最後のプローブへの応答に失敗したことを示します)
</LI></UL>
<P>その後に、モニターされているマシンのリストが続きます。マシンに出されているアラートがある場合、ホスト名の左の大括弧内に、アラートの数が表示されます。プロセスが最後のプローブへの応答に失敗すると、ホスト名の左の大括弧内に、<TT>PF</TT> (プローブ失敗) という文字が表示されます。
<P><B>ファイル・サーバー画面</B>
<P>[<TT>ファイル・サーバー</TT>] 画面は、ファイル・サーバー統計の最新のプローブで収集された値を表示します。
<P>画面上部の合計行 (標準プログラム・バージョンと画面タイトル・ブロックのすぐ下) は、モニターされたファイル・サーバーの数、アラート回数、およびアラートの影響を受けたマシンの数を指定します。
<P>最初の列には、モニターされたファイル・サーバーを実行しているマシンのホスト名が常に表示されます。
<P>ホスト名列の右には、表示画面またはウィンドウの現行幅に収まる数の統計の列が表示されます。各列には、10 文字分のスペースが必要です。統計の名前は、各列の一番上に表示されます。マシン上のファイル・サーバーが最新のプローブに応答しなかった場合、各列に、1 対のダッシュ (<TT>--</TT>) が表示されます。値が構成済みのしきい値を超えた場合、その値が反転表示で強調されます。値が長すぎて割り振られた列幅に収まらない場合、その値は、次の行の同じ列にあふれます。
<P><B>キャッシュ・マネージャー画面</B>
<P>[<TT>キャッシュ・マネージャー</TT>] 画面は、キャッシュ・マネージャー統計の最新のプローブで収集された値を表示します。
<P>画面上部の合計行 (標準プログラム・バージョンと画面タイトル・ブロックのすぐ下) は、モニターされたキャッシュ・マネージャーの数、アラート回数、およびアラートの影響を受けたマシンの数を指定します。
<P>最初の列には、モニターされたキャッシュ・マネージャーを実行しているマシンのホスト名が常に表示されます。
<P>ホスト名列の右には、表示画面またはウィンドウの現行幅に収まる数の統計の列が表示されます。各列には、10 文字分のスペースが必要です。統計の名前は、各列の一番上に表示されます。マシン上のキャッシュ・マネージャーが最新のプローブに応答しなかった場合、各列に、1 対のダッシュ (<TT>--</TT>) が表示されます。値が構成済みのしきい値を超えた場合、その値が反転表示で強調されます。値が長すぎて割り振られた列幅に収まらない場合、その値は、次の行の同じ列にあふれます。
<P><B>出力ファイルへの書き込み</B>
<P><B>afsmonitor</B> プログラムが集めるすべての統計の書き込み先ファイルを指定する、
<B>-output</B> 引き数を組み込みます。出力ファイルは、長期間に渡るパフォーマンスの追跡に役立ち、システムの動向を明らかにする後処理技法を管理者が適用できるようにします。
AFS 分散は、任意の後処理プログラムを組み込みません。
<P>出力ファイルは ASCII 形式で、
[<TT>ファイル・サーバー</TT>] または [<TT>キャッシュ・マネージャー</TT>] 表示画面と同じ情報を記録します。ファイルの各行には、
<B>afsmonitor</B> プログラムが指示された統計を集める時刻を記録する、次のような形式が使用されます。この統計は、
<VAR>host_name</VAR> と呼ばれるマシンで実行しているキャッシュ・マネージャー (<TT>CM</TT>) またはファイル・サーバー (<TT>FS</TT>) から集められます。プローブが失敗すると、エラー・コード <TT>-1</TT> が <VAR>statistic</VAR> フィールドに表示されます。
<PRE>      <VAR>time</VAR>  <VAR>host_name</VAR>  CM|FS   <VAR>statistic</VAR>

</PRE>
<P>管理者が、出力ファイルを自動解析プログラムまたはスクリプトに入力して処理するのではなく、普通に手作業で出力ファイルを検討する場合、
<B>-detail</B> フラグを指定しておけば、さらに読みやすい形式でデータを書式化することができます。
<P><STRONG>例</STRONG>
<P>コマンド、画面表示、および構成ファイルの例については、
<I>AFS 管理の手引き</I> の <B>afsmonitor</B> プログラムに関するセクションを参照してください。
<P><STRONG>必要となる特権</STRONG>
<P>なし。
<P><STRONG>関連情報 </STRONG>
<P><A HREF="auarf052.htm#HDRAFSMONCONFIG">afsmonitor 構成ファイル</A>
<P><A HREF="auarf169.htm#HDRFSTRACE_INTRO">fstrace</A>
<P><A HREF="auarf233.htm#HDRSCOUT">scout</A>
<P>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auarf058.htm">前ページ</A> &#124; <A HREF="auarf060.htm">次ページ</A> &#124; <A HREF="auarf002.htm#ToC">目次</A> &#124; <A HREF="auarf284.htm#HDRINDEX">索引</A> &#93;</B>
<!-- Begin Footer Records  ========================================== -->
<P><HR><B>
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved
</B>
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
